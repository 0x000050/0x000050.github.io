<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>Lynn's Blog</title>
 <link href="http://0.0.0.0:4000/atom.xml" rel="self"/>
 <link href="http://0.0.0.0:4000/"/>
 <updated>2018-08-19T11:44:09+08:00</updated>
 <id>http://0.0.0.0:4000</id>
 <author>
   <name>Lynn Wu</name>
   <email>0x000050@gmail.com</email>
 </author>

 
 <entry>
   <title>2017 Flare-On Challenge 3 Greektome.exe</title>
   <link href="http://0.0.0.0:4000/2018/05/22/2017-Flare-On-3-Greektome/"/>
   <updated>2018-05-22T00:00:00+08:00</updated>
   <id>http://0.0.0.0:4000/2018/05/22/2017 Flare-On #3 Greektome</id>
   <content type="html">&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Greek_to_me.exe&lt;/code&gt; is a Windows x86 executable. When we launch the binary, we can’t input anything, and we don’t get any output from the binary. It gets stuck waiting for us to do something.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Analysis:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When we open it in IDA, we can see it contains the &lt;code class=&quot;highlighter-rouge&quot;&gt;socket&lt;/code&gt; function at &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401151&lt;/code&gt;, the binary using a standard series of Windows API functions: &lt;code class=&quot;highlighter-rouge&quot;&gt;socket&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;bind&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;listen&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;accept&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;So far we know the binary listening for a TCP connection from localhost on port 2222 (0x8AE). It then proceeds to read up to 8-bit register in &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_401121&lt;/code&gt;, and the input is a 32-bit integer.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/szZCmXr.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Additionally, there has some interesting string of the program at virtual address &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401101&lt;/code&gt;, that is &lt;code class=&quot;highlighter-rouge&quot;&gt;Congratulations! But wait, where',27h,'s my flag?&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/fSeXBij.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401036&lt;/code&gt;, the first byte from the recv buffer is moved into the lower eight bits of the EDX register. Then, focus on &lt;code class=&quot;highlighter-rouge&quot;&gt;loc_40107C&lt;/code&gt; function and &lt;code class=&quot;highlighter-rouge&quot;&gt;loc_401039&lt;/code&gt; function, the address &lt;code class=&quot;highlighter-rouge&quot;&gt;0x40107C&lt;/code&gt; is moved into the &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt; register, representing the start address for the decoding loop.&lt;/p&gt;

&lt;p&gt;The decoding loop contains some operations. First of all, take a one byte at the address stored in &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt; (&lt;code class=&quot;highlighter-rouge&quot;&gt;0x40107C&lt;/code&gt;). Next, XOR the extracted byte with the first byte received over the listening socket, then incremented by 34 (0x22). Use the resulting byte to overwrite the byte extracted in &lt;code class=&quot;highlighter-rouge&quot;&gt;EAX&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/tx8jK96.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Further, &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_4011E6&lt;/code&gt; function is used to hash, arguments are the start address of the modified code (&lt;code class=&quot;highlighter-rouge&quot;&gt;0x40107C&lt;/code&gt;) and the length value 121 (0x79). In &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_4011E6&lt;/code&gt; function, a 16 bits (&lt;code class=&quot;highlighter-rouge&quot;&gt;AX&lt;/code&gt;) hash data is calculated and checked against 64350 (0xFB5E) for equality. If the hash data matches, the code is executed, without getting an error message &lt;code class=&quot;highlighter-rouge&quot;&gt;Nope, that’s not it&lt;/code&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Solutions:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The key is only a single byte, but there are 256 possibilities. Following python code to help us get &lt;code class=&quot;highlighter-rouge&quot;&gt;0xA2&lt;/code&gt; (&lt;code class=&quot;highlighter-rouge&quot;&gt;ó&lt;/code&gt;) as the key:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; 
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;string&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#scoket info&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;HOST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'127.0.0.1'&lt;/span&gt;    
&lt;span class=&quot;n&quot;&gt;PORT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2222&lt;/span&gt;              

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;#open exe&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;filepath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'greek_to_me.exe'&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;startfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;c&quot;&gt;#connect socket&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HOST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PORT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Congratulations! But wait, where's my flag?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Received'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Put a breakpoints at &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401063&lt;/code&gt; with IDA, we can find the flag that got written to the stack was &lt;code class=&quot;highlighter-rouge&quot;&gt;et_tu_brute_force@flare-on.com&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Notes:
    &lt;ul&gt;
      &lt;li&gt;Compared with &lt;code class=&quot;highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;0.0.0.0&lt;/code&gt;:
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; is only for local interface, when a server listen &lt;code class=&quot;highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; that means “only communicate within the same host”.&lt;/li&gt;
          &lt;li&gt;when a server listen on &lt;code class=&quot;highlighter-rouge&quot;&gt;0.0.0.0&lt;/code&gt; that means “listen on every available network interface”.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;Challenge Author: Matt Williams (@0xmwilliams)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/0x000050/CTF/blob/master/2017_Flare-On/03_Greek_to_me/greek_to_me.exe&quot;&gt;Challenge download&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>2017 Flare-On Challenge 2 IgniteMe.exe</title>
   <link href="http://0.0.0.0:4000/2018/05/20/2017-Flare-On-2-IgniteMe/"/>
   <updated>2018-05-20T00:00:00+08:00</updated>
   <id>http://0.0.0.0:4000/2018/05/20/2017 Flare-On #2 IgniteMe</id>
   <content type="html">&lt;p&gt;This is a crack me challenge. &lt;code class=&quot;highlighter-rouge&quot;&gt;IgniteMe.exe&lt;/code&gt; expects to run without any command line argument. It asks the player to input the flag and checks whether it’s correct or not.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:\Users\nnyl\Desktop\flareon4\Challenge2&amp;gt;IgniteMe.exe
G1v3 m3 t3h fl4g:  flareon
N0t t00 h0t R we? 7ry 4ga1nz plzzz!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Analysis:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/3rA8jZy.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sub_4010F0&lt;/code&gt; function is used to read user input data，and stored the user input data at &lt;code class=&quot;highlighter-rouge&quot;&gt;0x403078&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_401050&lt;/code&gt; function is flag validation function, focusing on code block between &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401088&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;0x4010AD&lt;/code&gt;, you can see where the input is processed by xor loop, and checks it against some data &lt;code class=&quot;highlighter-rouge&quot;&gt;enc&lt;/code&gt; (at &lt;code class=&quot;highlighter-rouge&quot;&gt;0x0403000&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/hoqtTCR.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sub_401000&lt;/code&gt; function is used to generate key, we can get an initial seed to be the number 4.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Solutions:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In the first loop, &lt;code class=&quot;highlighter-rouge&quot;&gt;IgniteMe.exe&lt;/code&gt; XOR’s 0x04 with the last character of user input data.  The result is then XOR’d with the second from last char, and it keeps on going.  The global variable &lt;code class=&quot;highlighter-rouge&quot;&gt;byte_403180&lt;/code&gt; stores the encoded user input data.&lt;/p&gt;

&lt;p&gt;Upon completion of encoded user input data, checks for correctness of the decrypted data (&lt;code class=&quot;highlighter-rouge&quot;&gt;enc&lt;/code&gt;). if it correct print &lt;code class=&quot;highlighter-rouge&quot;&gt;G00d j0b!&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Therefore, we can bruteforced the &lt;code class=&quot;highlighter-rouge&quot;&gt;enc&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.data:00403000 ; char enc[]
.data:00403000 enc dd 4549260Dh
.data:00403004 dd 4478172Ah
.data:00403008 dd 5E5D6C2Bh
.data:0040300C dd 172F1245h
.data:00403010 dd 6E6F442Bh
.data:00403014 dd 455F0956h
.data:00403018 dd 0A267347h
.data:0040301C dd 4817130Dh
.data:00403020 dd 4D400142h
.data:00403024 dd 69020Ch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The following script obtains the flag.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x49&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x78&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x2B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x56&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x5F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x73&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x02&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x69&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;                    &lt;span class=&quot;c&quot;&gt;#key&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;Challenge #2 by Nhan Huynh&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/0x000050/CTF/blob/master/2017_Flare-On/02_IgniteMe/IgniteMe.exe&quot;&gt;Challenge download&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>2017 Flare-On Challenge 1 login.html</title>
   <link href="http://0.0.0.0:4000/2018/05/10/2017-Flare-On-1-Login/"/>
   <updated>2018-05-10T00:00:00+08:00</updated>
   <id>http://0.0.0.0:4000/2018/05/10/2017 Flare-On #1 Login</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://flare-on.com&quot;&gt;Flare-On Challenge&lt;/a&gt; is the FireEye Labs Advanced Reverse Engineering (FLARE) team’s yearly reverse engineering contest. This is a CTF-style challenge for all active and aspiring reverse engineers, malware analysts, and security professionals.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/0x000050/CTF/tree/master/2017_Flare-On&quot;&gt;Challenges download&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;a href=&quot;https://www.fireeye.com/blog/threat-research/2017/10/2017-flare-on-challenge-solutions.html&quot;&gt;solutions&lt;/a&gt; written by each challenge author&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;p&gt;login.html&lt;/p&gt;

&lt;p&gt;There is an HTML file with a form. We need to provide a flag and check for its correctness.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/BkoCOyn.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here is the content of &lt;code class=&quot;highlighter-rouge&quot;&gt;login.html&lt;/code&gt;, the HTML page containing a simple client-side JavaScript authentication using ROT-13.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE Html /&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;FLARE On 2017&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;flag&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;flag&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Enter the flag&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;prompt&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Click to check the flag&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;prompt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onclick&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 	 &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 	 &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rotFlag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;a-zA-Z&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
 	 &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fromCharCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Z&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;90&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;122&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);});&lt;/span&gt;
 	 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;rotFlag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 	  &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Correct flag!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 	 &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 	  &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Incorrect flag, rot again&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 	  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 	 &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use python to decode and extract this flag.&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'rot13'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we enter &lt;code class=&quot;highlighter-rouge&quot;&gt;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&lt;/code&gt; as the input, the message box shows us the flag for this challenge: &lt;code class=&quot;highlighter-rouge&quot;&gt;ClientSideLoginsAreEasy@flare-on.com&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;
&lt;ul&gt;
  &lt;li&gt;Challenge #1 by Dominik Weber (@Invalid_handle)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/0x000050/CTF/blob/master/2017_Flare-On/01_Login/login.html&quot;&gt;Challenge download&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>2017 HITCON CMT mini wargame Reverse</title>
   <link href="http://0.0.0.0:4000/2017/08/26/2017-HITCON-CMT-mini-wargame/"/>
   <updated>2017-08-26T00:00:00+08:00</updated>
   <id>http://0.0.0.0:4000/2017/08/26/2017 HITCON CMT mini wargame</id>
   <content type="html">&lt;p&gt;今年 HITCON 在 HITCON CMT 研討會期間又舉辦了與前幾年類似的 wargame，相較於 HITCON CTF 是比較簡單的小型競賽。很幸運跟以色列的朋友一起組隊，因為我很 Lazy 而他們是 Hacker，所以隊名就取 &lt;code class=&quot;highlighter-rouge&quot;&gt;Lazyhacker&lt;/code&gt;。在團隊中我負責解 Reverse 的題型，這次 Reverse 只有兩題，都是 Windows 題，分別是小算盤跟踩地雷，還蠻有趣的，所以想紀錄一下。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;100-calcexe&quot;&gt;[100] calc.exe&lt;/h2&gt;
&lt;h3 id=&quot;題目描述&quot;&gt;題目描述&lt;/h3&gt;
&lt;p&gt;毫無反應，就是一個具有計算功能的計算機。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/DMo6dMi.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;解法&quot;&gt;解法&lt;/h3&gt;

&lt;p&gt;觀察發現似乎跟 Windows 的小算盤一模一樣，因此拿了 Windows 原版的 &lt;code class=&quot;highlighter-rouge&quot;&gt;calc.exe&lt;/code&gt; 執行檔來做 diff ( 這裡用 &lt;code class=&quot;highlighter-rouge&quot;&gt;vimdiff&lt;/code&gt; )，發現其中多了一些看起來很可疑的 code&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/6NRAkp5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;放進 IDA Pro 分析 &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_10136B0()&lt;/code&gt; (可以 search opcode 或計算 offset)，得知是在做某種字串的比對&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/NAUhSNt.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;簡化來說，就是取數字框的 &lt;code class=&quot;highlighter-rouge&quot;&gt;HWND&lt;/code&gt;，讀數字框上面的文字，並驗證這段文字&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HWND hwnd = GetDlgItem(g_hWnd, 403);  //  403 是數字框的控制項 ID
GetWindowTextA(hwnd, buf, 256);
驗證這段文字
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[補充] 控制項的 ID 可以透過 Resource Hacker 來看
&lt;img src=&quot;https://i.imgur.com/VPDAWFP.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;也可以用 ollydbg 追蹤來理解程式的行為，透過追蹤可以知道: 當按下 &lt;code class=&quot;highlighter-rouge&quot;&gt;=&lt;/code&gt; 時，會跳到這個有被改過的地方，至於要輸入什麼數字才會跳出 FLAG 呢? 可以停在 &lt;code class=&quot;highlighter-rouge&quot;&gt;101371A&lt;/code&gt; 這裡看他怎麼比較的，他比較的值分別是&lt;code class=&quot;highlighter-rouge&quot;&gt;0x31323035&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;0x32303536&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;0x352E3631&lt;/code&gt; 與 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x36313230&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/jl2IAu6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;對照 ASCII 表並考慮 little endian 的話，就是 &lt;code class=&quot;highlighter-rouge&quot;&gt;5021650216.50216&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0x31323035 --&amp;gt; 5021
0x32303536 --&amp;gt; 6502
0x352E3631 --&amp;gt; 16.5
0x36313230 --&amp;gt; 0216
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果用 IDA Pro 來看的話也可以解回來，判斷的部分為
&lt;img src=&quot;https://i.imgur.com/kQuEkdy.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;因此只要在視窗中輸入&lt;code class=&quot;highlighter-rouge&quot;&gt;5021650216.50216&lt;/code&gt; 並按下 &lt;code class=&quot;highlighter-rouge&quot;&gt;=&lt;/code&gt; 
&lt;img src=&quot;https://i.imgur.com/7qEETTe.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;就會跳出小框框顯示 Flag 
&lt;img src=&quot;https://i.imgur.com/QTbNeYZ.png&quot; alt=&quot;&quot; /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;The flag is: hitcon{50216_is_our_god}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;200-winmineexe&quot;&gt;[200] winmine.exe&lt;/h2&gt;
&lt;h3 id=&quot;題目描述-1&quot;&gt;題目描述&lt;/h3&gt;
&lt;p&gt;一個不平凡的踩地雷，開啟就是 40*40 的大小，除了特定的位置外，其他格子都是地雷&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/f4v3lfE.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;https://i.imgur.com/PbyCTrV.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;解法-1&quot;&gt;解法&lt;/h3&gt;
&lt;p&gt;踩地雷遊戲，執行後很幸運地踩到了幾次正確位置&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/16XPA2L.jpg&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;https://i.imgur.com/jmsMbVy.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;猜想 “正確位置出現的形狀” 可能依序就是整串 FLAG 依序出現的順序( 可能是 &lt;code class=&quot;highlighter-rouge&quot;&gt;THE flag is hitcon{xxx}&lt;/code&gt; 之類的 )，因此期望在 IDA Pro 之中看到放的位置&lt;/p&gt;

&lt;p&gt;在 &lt;code class=&quot;highlighter-rouge&quot;&gt;sub_962880()&lt;/code&gt; 之中有 &lt;code class=&quot;highlighter-rouge&quot;&gt;MessageBoxA(0, &quot;Are u a hacker O_o?&quot;, &quot;O_o?&quot;, 0x20u);&lt;/code&gt; 猜想可能驗證 flag 相關的東西在附近&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.text:009629E1 loc_9629E1:                             ; CODE XREF: sub_962880+12Dj
.text:009629E1                 mov     ebx, ds:GetTickCount
.text:009629E7                 add     edi, 0FFFFFFFDh
.text:009629EA                 call    ebx ; GetTickCount
.text:009629EC                 xor     edx, edx
.text:009629EE                 mov     ecx, 0FFh
.text:009629F3                 div     ecx
.text:009629F5                 mov     esi, edx
.text:009629F7                 call    sub_965797
.text:009629FC                 add     eax, esi
.text:009629FE                 xor     edx, edx
.text:00962A00                 div     edi
.text:00962A02                 lea     esi, [edx+1]
.text:00962A05                 call    ebx ; GetTickCount
.text:00962A07                 call    sub_965797
.text:00962A0C                 mov     ecx, g_check
.text:00962A12                 mov     edx, 5
.text:00962A17                 shl     ecx, 4
.text:00962A1A                 sub     ecx, g_check
.text:00962A20                 imul    eax, esi, 65h
.text:00962A23                 add     ecx, offset g_enc
.text:00962A29                 add     eax, offset unk_9775E1
.text:00962A2E                 xchg    ax, ax
.text:00962A30

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;最後從 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00962A23&lt;/code&gt; 跳過去 &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00973BD9&lt;/code&gt; 會看到這段&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.rdata:00973BD8                 db    1
.rdata:00973BD9 g_enc           db    1                 ; DATA XREF: sub_962880+1A3o
.rdata:00973BDA                 db    1
.rdata:00973BDB                 db    0
.rdata:00973BDC                 db    1
.rdata:00973BDD                 db    0
.rdata:00973BDE                 db    0
.rdata:00973BDF                 db    1
.rdata:00973BE0                 db    0
.rdata:00973BE1                 db    0
.rdata:00973BE2                 db    1
.rdata:00973BE3                 db    0
.rdata:00973BE4                 db    0
.rdata:00973BE5                 db    1
.rdata:00973BE6                 db    0
.rdata:00973BE7                 db    1
.rdata:00973BE8                 db    0
.rdata:00973BE9                 db    1
.rdata:00973BEA                 db    1
.rdata:00973BEB                 db    0
.rdata:00973BEC                 db    1
.rdata:00973BED                 db    1
.rdata:00973BEE                 db    1
.rdata:00973BEF                 db    1
.rdata:00973BF0                 db    1
.rdata:00973BF1                 db    0
.rdata:00973BF2                 db    1
.rdata:00973BF3                 db    1
.rdata:00973BF4                 db    0
.rdata:00973BF5                 db    1
.rdata:00973BF6                 db    1
.rdata:00973BF7                 db    1
.rdata:00973BF8                 db    1
.rdata:00973BF9                 db    1
.rdata:00973BFA                 db    0
.rdata:00973BFB                 db    0
.rdata:00973BFC                 db    1
.rdata:00973BFD                 db    1
.rdata:00973BFE                 db    1
.rdata:00973BFF                 db    1
.rdata:00973C00                 db    0
.rdata:00973C01                 db    0
.rdata:00973C02                 db    1
.rdata:00973C03                 db    1
.rdata:00973C04                 db    1
.rdata:00973C05                 db    1
.rdata:00973C06                 db    1
.rdata:00973C07                 db    1
.rdata:00973C08                 db    1
.rdata:00973C09                 db    0
.rdata:00973C0A                 db    0
.rdata:00973C0B                 db    1
.rdata:00973C0C                 db    1
.rdata:00973C0D                 db    1
.rdata:00973C0E                 db    1
.rdata:00973C0F                 db    0
.rdata:00973C10                 db    0
.rdata:00973C11                 db    1
.rdata:00973C12                 db    0
.rdata:00973C13                 db    0
.rdata:00973C14                 db    1
.rdata:00973C15                 db    0
.rdata:00973C16                 db    0
.rdata:00973C17                 db    1
.rdata:00973C18                 db    0
.rdata:00973C19                 db    0
.rdata:00973C1A                 db    1
.rdata:00973C1B                 db    0
.rdata:00973C1C                 db    0
.rdata:00973C1D                 db    1
.rdata:00973C1E                 db    0
.rdata:00973C1F                 db    0
.rdata:00973C20                 db    1
.rdata:00973C21                 db    1
.rdata:00973C22                 db    1
.rdata:00973C23                 db    1
.rdata:00973C24                 db    1
.rdata:00973C25                 db    1
.rdata:00973C26                 db    1
.rdata:00973C27                 db    0
.rdata:00973C28                 db    1
.rdata:00973C29                 db    1
.rdata:00973C2A                 db    1
.rdata:00973C2B                 db    1
.rdata:00973C2C                 db    1
.rdata:00973C2D                 db    0
.rdata:00973C2E                 db    1
.rdata:00973C2F                 db    1
.rdata:00973C30                 db    0
.rdata:00973C31                 db    1
.rdata:00973C32                 db    1
.rdata:00973C33                 db    1
.rdata:00973C34                 db    1
.rdata:00973C35                 db    1
.rdata:00973C36                 db    0
.rdata:00973C37                 db    0
.rdata:00973C38                 db    1
.rdata:00973C39                 db    0
.rdata:00973C3A                 db    1
.rdata:00973C3B                 db    1
.rdata:00973C3C                 db    0
.rdata:00973C3D                 db    1
.rdata:00973C3E                 db    1
.rdata:00973C3F                 db    1
.rdata:00973C40                 db    1
.rdata:00973C41                 db    1
.rdata:00973C42                 db    1
.rdata:00973C43                 db    1
.rdata:00973C44                 db    0
.rdata:00973C45                 db    1
.rdata:00973C46                 db    0
.rdata:00973C47                 db    0
.rdata:00973C48                 db    1
.rdata:00973C49                 db    0
.rdata:00973C4A                 db    0
.rdata:00973C4B                 db    1
.rdata:00973C4C                 db    0
.rdata:00973C4D                 db    1
.rdata:00973C4E                 db    1
.rdata:00973C4F                 db    1
.rdata:00973C50                 db    1
.rdata:00973C51                 db    1
.rdata:00973C52                 db    1
.rdata:00973C53                 db    1
.rdata:00973C54                 db    0
.rdata:00973C55                 db    0
.rdata:00973C56                 db    1
.rdata:00973C57                 db    1
.rdata:00973C58                 db    1
.rdata:00973C59                 db    0
.rdata:00973C5A                 db    0
.rdata:00973C5B                 db    1
.rdata:00973C5C                 db    1
.rdata:00973C5D                 db    1
.rdata:00973C5E                 db    1
.rdata:00973C5F                 db    1
.rdata:00973C60                 db    0
.rdata:00973C61                 db    0
.rdata:00973C62                 db    1
.rdata:00973C63                 db    0
.rdata:00973C64                 db    0
.rdata:00973C65                 db    1
.rdata:00973C66                 db    1
.rdata:00973C67                 db    1
.rdata:00973C68                 db    1
.rdata:00973C69                 db    0
.rdata:00973C6A                 db    1
.rdata:00973C6B                 db    1
.rdata:00973C6C                 db    0
.rdata:00973C6D                 db    1
.rdata:00973C6E                 db    0
.rdata:00973C6F                 db    0
.rdata:00973C70                 db    0
.rdata:00973C71                 db    0
.rdata:00973C72                 db    1
.rdata:00973C73                 db    0
.rdata:00973C74                 db    0
.rdata:00973C75                 db    0
.rdata:00973C76                 db    0
.rdata:00973C77                 db    0
.rdata:00973C78                 db    1
.rdata:00973C79                 db    0
.rdata:00973C7A                 db    0
.rdata:00973C7B                 db    1
.rdata:00973C7C                 db    0
.rdata:00973C7D                 db    0
.rdata:00973C7E                 db    0
.rdata:00973C7F                 db    0
.rdata:00973C80                 db    0
.rdata:00973C81                 db    1
.rdata:00973C82                 db    0
.rdata:00973C83                 db    1
.rdata:00973C84                 db    1
.rdata:00973C85                 db    1
.rdata:00973C86                 db    0
.rdata:00973C87                 db    1
.rdata:00973C88                 db    0
.rdata:00973C89                 db    0
.rdata:00973C8A                 db    1
.rdata:00973C8B                 db    0
.rdata:00973C8C                 db    0
.rdata:00973C8D                 db    0
.rdata:00973C8E                 db    0
.rdata:00973C8F                 db    0
.rdata:00973C90                 db    0
.rdata:00973C91                 db    0
.rdata:00973C92                 db    1
.rdata:00973C93                 db    1
.rdata:00973C94                 db    1
.rdata:00973C95                 db    1
.rdata:00973C96                 db    0
.rdata:00973C97                 db    0
.rdata:00973C98                 db    1
.rdata:00973C99                 db    1
.rdata:00973C9A                 db    1
.rdata:00973C9B                 db    0
.rdata:00973C9C                 db    0
.rdata:00973C9D                 db    0
.rdata:00973C9E                 db    0
.rdata:00973C9F                 db    0
.rdata:00973CA0                 db    0
.rdata:00973CA1                 db    1
.rdata:00973CA2                 db    1
.rdata:00973CA3                 db    1
.rdata:00973CA4                 db    1
.rdata:00973CA5                 db    0
.rdata:00973CA6                 db    1
.rdata:00973CA7                 db    1
.rdata:00973CA8                 db    1
.rdata:00973CA9                 db    1
.rdata:00973CAA                 db    0
.rdata:00973CAB                 db    0
.rdata:00973CAC                 db    0
.rdata:00973CAD                 db    0
.rdata:00973CAE                 db    0
.rdata:00973CAF                 db    0
.rdata:00973CB0                 db    1
.rdata:00973CB1                 db    1
.rdata:00973CB2                 db    0
.rdata:00973CB3                 db    1
.rdata:00973CB4                 db    0
.rdata:00973CB5                 db    1
.rdata:00973CB6                 db    1
.rdata:00973CB7                 db    0
.rdata:00973CB8                 db    1
.rdata:00973CB9                 db    0
.rdata:00973CBA                 db    1
.rdata:00973CBB                 db    1
.rdata:00973CBC                 db    0
.rdata:00973CBD                 db    1
.rdata:00973CBE                 db    0
.rdata:00973CBF                 db    1
.rdata:00973CC0                 db    1
.rdata:00973CC1                 db    0
.rdata:00973CC2                 db    0
.rdata:00973CC3                 db    1
.rdata:00973CC4                 db    0
.rdata:00973CC5                 db    0
.rdata:00973CC6                 db    1
.rdata:00973CC7                 db    1
.rdata:00973CC8                 db    1
.rdata:00973CC9                 db    1
.rdata:00973CCA                 db    0
.rdata:00973CCB                 db    1
.rdata:00973CCC                 db    0
.rdata:00973CCD                 db    1
.rdata:00973CCE                 db    1
.rdata:00973CCF                 db    1
.rdata:00973CD0                 db    1
.rdata:00973CD1                 db    1
.rdata:00973CD2                 db    0
.rdata:00973CD3                 db    1
.rdata:00973CD4                 db    1
.rdata:00973CD5                 db    1
.rdata:00973CD6                 db    1
.rdata:00973CD7                 db    1
.rdata:00973CD8                 db    1
.rdata:00973CD9                 db    1
.rdata:00973CDA                 db    1
.rdata:00973CDB                 db    0
.rdata:00973CDC                 db    1
.rdata:00973CDD                 db    1
.rdata:00973CDE                 db    0
.rdata:00973CDF                 db    1
.rdata:00973CE0                 db    1
.rdata:00973CE1                 db    0
.rdata:00973CE2                 db    1
.rdata:00973CE3                 db    1
.rdata:00973CE4                 db    1
.rdata:00973CE5                 db    1
.rdata:00973CE6                 db    1
.rdata:00973CE7                 db    1
.rdata:00973CE8                 db    1
.rdata:00973CE9                 db    1
.rdata:00973CEA                 db    0
.rdata:00973CEB                 db    1
.rdata:00973CEC                 db    1
.rdata:00973CED                 db    0
.rdata:00973CEE                 db    1
.rdata:00973CEF                 db    1
.rdata:00973CF0                 db    0
.rdata:00973CF1                 db    1
.rdata:00973CF2                 db    1
.rdata:00973CF3                 db    1
.rdata:00973CF4                 db    1
.rdata:00973CF5                 db    1
.rdata:00973CF6                 db    0
.rdata:00973CF7                 db    1
.rdata:00973CF8                 db    1
.rdata:00973CF9                 db    1
.rdata:00973CFA                 db    1
.rdata:00973CFB                 db    1
.rdata:00973CFC                 db    0
.rdata:00973CFD                 db    1
.rdata:00973CFE                 db    1
.rdata:00973CFF                 db    0
.rdata:00973D00                 db    1
.rdata:00973D01                 db    1
.rdata:00973D02                 db    0
.rdata:00973D03                 db    1
.rdata:00973D04                 db    0
.rdata:00973D05                 db    1
.rdata:00973D06                 db    0
.rdata:00973D07                 db    0
.rdata:00973D08                 db    1
.rdata:00973D09                 db    0
.rdata:00973D0A                 db    0
.rdata:00973D0B                 db    1
.rdata:00973D0C                 db    0
.rdata:00973D0D                 db    0
.rdata:00973D0E                 db    0
.rdata:00973D0F                 db    0
.rdata:00973D10                 db    0
.rdata:00973D11                 db    1
.rdata:00973D12                 db    0
.rdata:00973D13                 db    1
.rdata:00973D14                 db    1
.rdata:00973D15                 db    0
.rdata:00973D16                 db    0
.rdata:00973D17                 db    1
.rdata:00973D18                 db    0
.rdata:00973D19                 db    0
.rdata:00973D1A                 db    1
.rdata:00973D1B                 db    1
.rdata:00973D1C                 db    0
.rdata:00973D1D                 db    1
.rdata:00973D1E                 db    0
.rdata:00973D1F                 db    1
.rdata:00973D20                 db    1
.rdata:00973D21                 db    0
.rdata:00973D22                 db    0
.rdata:00973D23                 db    0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;將每 15 個字為一組，其中 3 個為一行的排法，排出第一個字為&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;111
010
010
010
010
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;看起來就是 &lt;code class=&quot;highlighter-rouge&quot;&gt;T&lt;/code&gt;，那麼將 22 個字解完就是 &lt;code class=&quot;highlighter-rouge&quot;&gt;THE FLAG is hitcon{BOOM!}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;如果出題者對這些字做 XOR 就比較困難了，好險好險&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;最後我們拿了第一名，感謝 Lazyhacker 、HITCON CMT 籌備團隊、mini wargame 出題者以及幫助過我的人&lt;/p&gt;

&lt;p&gt;後記: 結束後，跟 &lt;code class=&quot;highlighter-rouge&quot;&gt;d3vc0r3&lt;/code&gt; 交流，得知 Web 滲透測試專家對於 Reverse 題 &lt;code class=&quot;highlighter-rouge&quot;&gt;winmine.exe&lt;/code&gt; 的解法相當可愛，每猜中一個字，就利用 VMware 做 snapshot，如此一來，就可以輕鬆快樂的猜下一個字了，真是太睿智XD　&lt;/p&gt;
</content>
 </entry>
 

</feed>
